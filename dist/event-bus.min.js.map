{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dist/event-bus.min.js","webpack:///webpack/bootstrap df498b46013fc51b01db","webpack:///./src/index.ts","webpack:///./node_modules/@sardonyxwt/utils/object/object.min.js","webpack:///./node_modules/@sardonyxwt/utils/generator/generator.min.js"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","createEventBus","config","_a","generator_1","uniqueId","_b","isFrozen","eventBuses","Error","eventBus","EventBusImpl","eventBusDevTool","onCreate","getEventBus","eventBusName","setEventBusDevTool","devTool","assign","value","object_1","onEvent","_events","_queue","_listeners","_name","_isFrozen","slice","registerEvent","eventName","_this","find","it","push","capitalizeFirstLetterEventName","charAt","toUpperCase","subscriberMacroName","dispatcherMacroName","listener","subscribe","eventDispatcher","data","publish","deepFreeze","event","getOwnPropertyNames","forEach","key","reason","console","error","shift","length","nextEventDispatcher","isFirstInQuery","eventNames","Array","isArray","apply","findIndex","listenerId","unsubscribe","id","lock","e","t","r","default","3","freeze","Math","floor","random","u","join","generateSeed"],"mappings":"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","file":"./dist/event-bus.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"eventBus\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"eventBus\"] = factory();\n\telse\n\t\troot[\"eventBus\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"eventBus\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"eventBus\"] = factory();\n\telse\n\t\troot[\"eventBus\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar object_1 = __webpack_require__(1);\r\nvar generator_1 = __webpack_require__(2);\r\nvar eventBusDevTool = {\r\n    onCreate: function () { return null; },\r\n    onEvent: function () { return null; }\r\n};\r\nvar EventBusImpl = /** @class */ (function () {\r\n    function EventBusImpl(config) {\r\n        this._events = [];\r\n        this._queue = [];\r\n        this._listeners = {};\r\n        var name = config.name, isFrozen = config.isFrozen;\r\n        this._name = name;\r\n        this._isFrozen = isFrozen;\r\n    }\r\n    Object.defineProperty(EventBusImpl.prototype, \"name\", {\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventBusImpl.prototype, \"isLocked\", {\r\n        get: function () {\r\n            return this._isFrozen;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventBusImpl.prototype, \"supportEvents\", {\r\n        get: function () {\r\n            return this._events.slice();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    EventBusImpl.prototype.registerEvent = function (eventName) {\r\n        var _this = this;\r\n        if (this._isFrozen) {\r\n            throw new Error(\"This event bus is locked you can't add new event.\");\r\n        }\r\n        if (!!this._events.find(function (it) { return it === eventName; }) || (eventName in this)) {\r\n            throw new Error(\"Event with name \" + eventName + \" is duplicate or reserved in event bus \" + this._name + \".\");\r\n        }\r\n        this._events.push(eventName);\r\n        var capitalizeFirstLetterEventName = function () {\r\n            return eventName.charAt(0).toUpperCase() + eventName.slice(1);\r\n        };\r\n        var subscriberMacroName = \"on\" + capitalizeFirstLetterEventName();\r\n        var dispatcherMacroName = \"dispatch\" + capitalizeFirstLetterEventName();\r\n        this[subscriberMacroName] = function (listener) { return _this.subscribe(listener, eventName); };\r\n        var eventDispatcher = function (data) { return _this.publish(eventName, data); };\r\n        this[dispatcherMacroName] = eventDispatcher;\r\n        return eventDispatcher;\r\n    };\r\n    EventBusImpl.prototype.publish = function (eventName, data) {\r\n        var _this = this;\r\n        var eventDispatcher = function () {\r\n            if (data && typeof data === 'object') {\r\n                object_1.deepFreeze(data);\r\n            }\r\n            var event = {\r\n                eventBusName: _this._name,\r\n                eventName: eventName,\r\n                data: data\r\n            };\r\n            eventBusDevTool.onEvent(event);\r\n            Object.getOwnPropertyNames(_this._listeners).forEach(function (key) {\r\n                var listener = _this._listeners[key];\r\n                try {\r\n                    if (listener)\r\n                        listener(event);\r\n                }\r\n                catch (reason) {\r\n                    console.error(\"Event bus listener \" + key + \" error.\", event);\r\n                }\r\n            });\r\n            _this._queue.shift();\r\n            if (_this._queue.length > 0) {\r\n                var nextEventDispatcher = _this._queue[0];\r\n                nextEventDispatcher();\r\n            }\r\n        };\r\n        var isFirstInQuery = this._queue.length === 0;\r\n        this._queue.push(eventDispatcher);\r\n        if (isFirstInQuery) {\r\n            eventDispatcher();\r\n        }\r\n    };\r\n    EventBusImpl.prototype.subscribe = function (listener, eventName) {\r\n        var _this = this;\r\n        var eventNames = [];\r\n        if (Array.isArray(eventName)) {\r\n            eventNames.push.apply(eventNames, eventName);\r\n        }\r\n        else if (eventName) {\r\n            eventNames.push(eventName);\r\n        }\r\n        eventNames.forEach(function (eventName) {\r\n            if (_this._events.findIndex(function (it) { return it === eventName; }) === -1) {\r\n                throw new Error(\"Event (\" + eventName + \") not present in scope.\");\r\n            }\r\n        });\r\n        var listenerId = generator_1.uniqueId('listener');\r\n        this._listeners[listenerId] = function (event) {\r\n            if (eventNames.length === 0) {\r\n                return listener(event);\r\n            }\r\n            var isActionPresentInScope = eventNames.findIndex(function (eventName) { return eventName === event.eventName; }) !== -1;\r\n            if (isActionPresentInScope) {\r\n                listener(event);\r\n            }\r\n        };\r\n        return listenerId;\r\n    };\r\n    EventBusImpl.prototype.unsubscribe = function (id) {\r\n        return delete this._listeners[id];\r\n    };\r\n    EventBusImpl.prototype.lock = function () {\r\n        this._isFrozen = true;\r\n    };\r\n    return EventBusImpl;\r\n}());\r\nvar eventBuses = {};\r\nfunction createEventBus(config) {\r\n    if (config === void 0) { config = {}; }\r\n    var _a = config.name, name = _a === void 0 ? generator_1.uniqueId('eventBus') : _a, _b = config.isFrozen, isFrozen = _b === void 0 ? false : _b;\r\n    if (name in eventBuses) {\r\n        throw new Error(\"Event bus name must unique\");\r\n    }\r\n    var eventBus = new EventBusImpl({ name: name, isFrozen: isFrozen });\r\n    eventBuses[name] = eventBus;\r\n    eventBusDevTool.onCreate(eventBus);\r\n    return eventBus;\r\n}\r\nexports.createEventBus = createEventBus;\r\nfunction getEventBus(eventBusName) {\r\n    if (!eventBuses[eventBusName]) {\r\n        throw new Error(\"Event bus with name \" + eventBusName + \" not present\");\r\n    }\r\n    return eventBuses[eventBusName];\r\n}\r\nexports.getEventBus = getEventBus;\r\nfunction setEventBusDevTool(devTool) {\r\n    Object.assign(eventBusDevTool, devTool);\r\n}\r\nexports.setEventBusDevTool = setEventBusDevTool;\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n!function(e,t){if(true)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)(\"object\"==typeof exports?exports:e)[r]=n[r]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=3)}({3:function(e,t,n){\"use strict\";function r(e){return Object.getOwnPropertyNames(e).forEach(function(t){var n=e[t];\"object\"==typeof n&&null!==n&&r(n)}),Object.freeze(e)}Object.defineProperty(t,\"__esModule\",{value:!0}),t.deepFreeze=r}})});\n//# sourceMappingURL=object.min.js.map\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n!function(e,t){if(true)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)(\"object\"==typeof exports?exports:e)[r]=n[r]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=1)}([,function(e,t,n){\"use strict\";function r(e){for(var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",n=[];n.length<e;)n.push(t.charAt(Math.floor(Math.random()*t.length)));return n}function o(e,t){void 0===e&&(e=\"\"),void 0===t&&(t=!1),u[e]?++u[e]:u[e]=1;var n=e+u[e];return t&&(n=n+\"-\"+r(8).join(\"\")),n}Object.defineProperty(t,\"__esModule\",{value:!0});var u={};t.generateSeed=r,t.uniqueId=o}])});\n//# sourceMappingURL=generator.min.js.map\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// dist/event-bus.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap df498b46013fc51b01db","import {deepFreeze} from '@sardonyxwt/utils/object';\nimport {uniqueId} from '@sardonyxwt/utils/generator';\n\nexport type EventBusConfig = {\n  name?,\n  isFrozen?: boolean\n};\n\nexport type EventBusEvent = {\n  eventBusName: string,\n  eventName: string,\n  data?\n};\n\nexport type EventBusListener = (event: EventBusEvent) => void;\nexport type EventBusDispatcher = (data?) => void;\n\nexport interface EventBus {\n\n  readonly name: string;\n\n  readonly isLocked: boolean;\n\n  readonly supportEvents: string[];\n\n  registerEvent(eventName: string): EventBusDispatcher;\n\n  publish(eventName: string, data?): void;\n\n  subscribe(listener: EventBusListener, eventName?: string | string[]): string;\n\n  unsubscribe(id: string): boolean;\n\n  lock(): void;\n\n}\n\nexport interface EventBusDevTool {\n\n  onCreate(eventBus: EventBus): void;\n\n  onEvent(event: EventBusEvent): void;\n\n}\n\nlet eventBusDevTool: EventBusDevTool = {\n  onCreate: () => null,\n  onEvent: () => null\n};\n\nclass EventBusImpl implements EventBus {\n\n  private readonly _name: string;\n  private _isFrozen: boolean;\n  private _events: string[] = [];\n  private _queue: Function[] = [];\n  private _listeners: { [key: string]: EventBusListener } = {};\n\n  constructor(config: EventBusConfig) {\n    const {name, isFrozen} = config;\n    this._name = name;\n    this._isFrozen = isFrozen;\n  }\n\n  get name() {\n    return this._name;\n  }\n\n  get isLocked() {\n    return this._isFrozen;\n  }\n\n  get supportEvents() {\n    return [...this._events];\n  }\n\n  registerEvent(eventName: string) {\n    if (this._isFrozen) {\n      throw new Error(`This event bus is locked you can't add new event.`);\n    }\n    if (!!this._events.find(it => it === eventName) || (eventName in this)) {\n      throw new Error(`Event with name ${eventName} is duplicate or reserved in event bus ${this._name}.`);\n    }\n    this._events.push(eventName);\n\n    const capitalizeFirstLetterEventName = () => {\n      return eventName.charAt(0).toUpperCase() + eventName.slice(1);\n    };\n\n    const subscriberMacroName = `on${capitalizeFirstLetterEventName()}`;\n    const dispatcherMacroName = `dispatch${capitalizeFirstLetterEventName()}`;\n\n    this[subscriberMacroName] = (listener: EventBusListener) => this.subscribe(listener, eventName);\n\n    const eventDispatcher = (data?) => this.publish(eventName, data);\n\n    this[dispatcherMacroName] = eventDispatcher;\n\n    return eventDispatcher;\n  }\n\n  publish(eventName: string, data?) {\n    const eventDispatcher = () => {\n      if (data && typeof data === 'object') {\n        deepFreeze(data);\n      }\n\n      const event: EventBusEvent = {\n        eventBusName: this._name,\n        eventName,\n        data\n      };\n\n      eventBusDevTool.onEvent(event);\n\n      Object.getOwnPropertyNames(this._listeners).forEach(key => {\n        const listener = this._listeners[key];\n        try {\n          if (listener) listener(event);\n        } catch (reason) {\n          console.error(`Event bus listener ${key} error.`, event)\n        }\n      });\n\n      this._queue.shift();\n\n      if (this._queue.length > 0) {\n        const nextEventDispatcher = this._queue[0];\n        nextEventDispatcher();\n      }\n    };\n\n    const isFirstInQuery = this._queue.length === 0;\n\n    this._queue.push(eventDispatcher);\n\n    if (isFirstInQuery) {\n      eventDispatcher();\n    }\n  }\n\n  subscribe(listener: EventBusListener, eventName?: string | string[]) {\n    const eventNames: string[] = [];\n\n    if (Array.isArray(eventName)) {\n      eventNames.push(...eventName);\n    } else if (eventName) {\n      eventNames.push(eventName);\n    }\n\n    eventNames.forEach(eventName => {\n      if (this._events.findIndex(it => it === eventName) === -1) {\n        throw new Error(`Event (${eventName}) not present in scope.`);\n      }\n    });\n\n    const listenerId = uniqueId('listener');\n    this._listeners[listenerId] = event => {\n\n      if (eventNames.length === 0) {\n        return listener(event);\n      }\n\n      const isActionPresentInScope = eventNames.findIndex(\n        eventName => eventName === event.eventName\n      ) !== -1;\n\n      if (isActionPresentInScope) {\n        listener(event);\n      }\n    };\n    return listenerId;\n  }\n\n  unsubscribe(id: string) {\n    return delete this._listeners[id];\n  }\n\n  lock() {\n    this._isFrozen = true;\n  }\n\n}\n\nconst eventBuses: { [key: string]: EventBus } = {};\n\nexport function createEventBus(config: EventBusConfig = {}): EventBus {\n  const {\n    name = uniqueId('eventBus'),\n    isFrozen = false\n  } = config;\n  if (name in eventBuses) {\n    throw new Error(`Event bus name must unique`);\n  }\n  let eventBus = new EventBusImpl({name, isFrozen});\n  eventBuses[name] = eventBus;\n  eventBusDevTool.onCreate(eventBus);\n  return eventBus;\n}\n\nexport function getEventBus(eventBusName: string) {\n  if (!eventBuses[eventBusName]) {\n    throw new Error(`Event bus with name ${eventBusName} not present`);\n  }\n  return eventBuses[eventBusName];\n}\n\nexport function setEventBusDevTool(devTool: Partial<EventBusDevTool>) {\n  Object.assign(eventBusDevTool, devTool);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)(\"object\"==typeof exports?exports:e)[r]=n[r]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=3)}({3:function(e,t,n){\"use strict\";function r(e){return Object.getOwnPropertyNames(e).forEach(function(t){var n=e[t];\"object\"==typeof n&&null!==n&&r(n)}),Object.freeze(e)}Object.defineProperty(t,\"__esModule\",{value:!0}),t.deepFreeze=r}})});\n//# sourceMappingURL=object.min.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@sardonyxwt/utils/object/object.min.js\n// module id = 1\n// module chunks = 0","!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)(\"object\"==typeof exports?exports:e)[r]=n[r]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=1)}([,function(e,t,n){\"use strict\";function r(e){for(var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",n=[];n.length<e;)n.push(t.charAt(Math.floor(Math.random()*t.length)));return n}function o(e,t){void 0===e&&(e=\"\"),void 0===t&&(t=!1),u[e]?++u[e]:u[e]=1;var n=e+u[e];return t&&(n=n+\"-\"+r(8).join(\"\")),n}Object.defineProperty(t,\"__esModule\",{value:!0});var u={};t.generateSeed=r,t.uniqueId=o}])});\n//# sourceMappingURL=generator.min.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@sardonyxwt/utils/generator/generator.min.js\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}